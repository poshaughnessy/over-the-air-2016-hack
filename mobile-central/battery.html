<!DOCTYPE html>
<html>
  <head>
    <title>Web Bluetooth Battery</title>
  </head>
  <body>
    <h1>Web Bluetooth Battery</h1>
    <button id="btn-connect">Connect</button>
    <button id="btn-read">Read</button>
    <script>

      //var serviceUuid = '13333333-3333-3333-3333-333333333337';
      //var serviceUuid = 'd0611e78-bbb4-4591-a5f8-487910ae4366';
      //var serviceUuid = '03b80e5a-ede8-4b33-a751-6ce34ec4c700';
      var serviceUuid = 0x180F;
      //var charUuid = '13333333-3333-3333-3333-333333330001';
      var charUuid = 0x2A19;
      var characteristic;

      function connect() {

        navigator.bluetooth.requestDevice({
            filters: [{ services: [serviceUuid] }]
          })
          .then(function(device) {
            console.log('Device', device.name);
            return device.gatt.connect();
          })
          .then(function(server) {
            console.log('Server', server);
            return server.getPrimaryService(serviceUuid);
          })
          .then(function(service) {
            console.log('Service', service);
            return service.getCharacteristic(charUuid);
          })
          .then(function(char) {
            console.log('Characteristic', char);
            characteristic = char;
          });

      }

      function read() {
        return characteristic.readValue()
          .then(function(value) {
            var batteryLevel = value.getUint8(0);
            console.log('Battery level', batteryLevel);
          });
      }

      var btnConnect = document.getElementById('btn-connect');
      var btnRead = document.getElementById('btn-read');

      btnConnect.addEventListener('click', connect, false);
      btnRead.addEventListener('read', read, false);
    </script>
  </body>
</html>
